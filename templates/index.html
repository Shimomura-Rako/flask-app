<!-- âœ… index.html å…¨ã‚³ãƒ¼ãƒ‰ -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>~pamoka~ DMMè‹±ä¼šè©± äºˆç´„é€šçŸ¥ãƒ„ãƒ¼ãƒ«</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
  <div class="container mt-5">
    <h1 class="mb-4">~pamoka~ DMMè‹±ä¼šè©± äºˆç´„é€šçŸ¥ãƒ„ãƒ¼ãƒ«</h1>

    {% if user_id %}
      <div class="mb-4">
        <p>ğŸ†” ã‚ãªãŸã®ãƒ¦ãƒ¼ã‚¶ãƒ¼IDï¼š<strong>{{ user_id }}</strong>ï¼ˆã“ã®IDã‚’ãƒ¡ãƒ¢ã—ã¦ãŠãã¨åˆ¥ç«¯æœ«ã§ã‚‚ä½¿ãˆã¾ã™ï¼‰</p>
        <div class="btn-group">
          <a href="/set_user" class="btn btn-outline-secondary btn-sm">IDã‚’å¤‰æ›´ã™ã‚‹</a>
          <form method="POST" action="/reset_user" style="display:inline;">
            <button type="submit" class="btn btn-outline-danger btn-sm" onclick="return confirm('ãƒ‡ãƒ¼ã‚¿ã‚’å®Œå…¨ã«ãƒªã‚»ãƒƒãƒˆã—ã¦ã‚‚ã‚ˆã„ã§ã™ã‹ï¼Ÿ')">ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
          </form>
        </div>
      </div>
    {% endif %}

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <form method="POST" action="/">
      <div class="mb-3">
        <label for="teacher_id" class="form-label">è¬›å¸«ç•ªå·</label>
        <input type="text" class="form-control" id="teacher_id" name="teacher_id" required>
      </div>
      <div class="mb-3">
        <label for="pushbullet_token" class="form-label">Pushbullet ãƒˆãƒ¼ã‚¯ãƒ³</label>
        <input type="text" class="form-control" id="pushbullet_token" name="pushbullet_token" required>
      </div>
      <button type="submit" class="btn btn-primary">è¬›å¸«ã‚’ç™»éŒ²</button>
    </form>

<!-- âœ… ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã¸ã®æ¡ˆå†…ã‚’ã“ã“ã«è¿½åŠ  -->
<p class="mt-3">
  ä½¿ã„æ–¹ãŒåˆ†ã‹ã‚‰ãªã„æ–¹ã¯ <a href="/tutorial">ã“ã¡ã‚‰ã®ã‚¬ã‚¤ãƒ‰</a> ã‚’ã”è¦§ãã ã•ã„ã€‚
</p>


    <hr>
    <h2 class="mt-4">ç™»éŒ²æ¸ˆã¿ã®è¬›å¸«</h2>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>è¬›å¸«ç•ªå·</th>
          <th>è¬›å¸«å</th>
          <th>å‰Šé™¤</th>
        </tr>
      </thead>
      <tbody>
        {% for user in all_data %}
        <tr>
          <td>{{ user.teacher_id }}</td>
          <td>{{ user.teacher_name }}</td>
          <td>
            <form method="POST" action="/delete_teacher" style="display:inline;" onsubmit="return confirmDelete('{{ user.teacher_name }}')">
              <input type="hidden" name="teacher_id" value="{{ user.teacher_id }}">
              <button type="submit" class="btn btn-danger btn-sm">å‰Šé™¤</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>



    <script>
    document.addEventListener("DOMContentLoaded", function () {
      const tokenInput = document.getElementById("pushbullet_token");
      if (tokenInput) {
        const savedToken = localStorage.getItem("pushbullet_token") || "";
        tokenInput.value = savedToken;
      }

      // ğŸ”½ ã“ã“ãŒè¿½åŠ éƒ¨åˆ†ï¼šç™»éŒ²æ™‚ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿å­˜
      const registerForm = document.querySelector('form[action="/"]');
      if (registerForm) {
        registerForm.addEventListener("submit", function () {
          const token = document.getElementById("pushbullet_token")?.value;
          if (token) {
            localStorage.setItem("pushbullet_token", token);
          }
        });
      }
    });

    function confirmDelete(teacherName) {
      return confirm(`æœ¬å½“ã« ${teacherName} ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`);
    }
  </script>




  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
